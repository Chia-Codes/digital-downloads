{% extends "base.html" %}
{% load currency %}
{% block title %}Order Detail{% endblock %}
{% block content %}

<h1 class="h3 mb-3">Order {{ order.id }}</h1>

<ul class="list-unstyled mb-3">
  <li><strong>Date:</strong> {{ order.created_at|date:"Y-m-d H:i" }}</li>
  <li><strong>Status:</strong> {{ order.status|title }}</li>
  <li><strong>Total:</strong> £{{ order.total_pennies|pennies }}</li>
</ul>

<table class="table">
  <thead>
    <tr>
      <th>Product</th>
      <th class="text-end">Qty</th>
      <th class="text-end">Unit</th>
      <th class="text-end">Total</th>
    </tr>
  </thead>
  <tbody>
    {% for item in items %}
    <tr>
      <td>{{ item.product.title }}</td>
      <td class="text-end">{{ item.quantity }}</td>
      <td class="text-end">£{{ item.unit_price_pennies|pennies }}</td>
+     {# compute line_total = unit_price_pennies * quantity using widthratio #}
      {% widthratio item.unit_price_pennies item.unit_price_pennies item.quantity as line_total_raw %}
      <td class="text-end">
      {{ order.currency }} {{ line_total_raw|pennies }}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
