{% extends "base.html" %}
{% block title %}Cart · {{ block.super }}{% endblock %}
{% block content %}
<h1 class="h3 mb-3">Your Cart</h1>

<div id="cartTable" class="table-responsive">
  <table class="table align-middle">
    <thead>
      <tr><th>Product</th><th class="text-end">Qty</th><th class="text-end">Unit</th><th class="text-end">Line</th><th></th></tr>
    </thead>
    <tbody id="cartBody">
    {% for line in lines %}
      <tr data-product-id="{{ line.id }}">
        <td><a href="{% url 'catalog:detail' line.slug %}">{{ line.title }}</a></td>
        <td class="text-end" style="width: 110px;">
          <input type="number" class="form-control form-control-sm js-qty" value="{{ line.qty }}" min="1" aria-label="Quantity">
        </td>
        <td class="text-end">£{{ line.unit_price|add:"0"|slice:":-2" }}.{{ line.unit_price|stringformat:"02d"|slice:"-2:" }}</td>
        <td class="text-end js-line-total">£{{ line.line_total|add:"0"|slice:":-2" }}.{{ line.line_total|stringformat:"02d"|slice:"-2:" }}</td>
        <td class="text-end">
          <button class="btn btn-sm btn-outline-danger js-remove">Remove</button>
        </td>
      </tr>
    {% empty %}
      <tr><td colspan="5" class="text-center text-muted">Your cart is empty.</td></tr>
    {% endfor %}
    </tbody>
    <tfoot>
      <tr>
        <th colspan="3" class="text-end">Subtotal</th>
        <th class="text-end" id="js-subtotal">£{{ subtotal|add:"0"|slice:":-2" }}.{{ subtotal|stringformat:"02d"|slice:"-2:" }}</th>
        <th></th>
      </tr>
    </tfoot>
  </table>
</div>

<div class="d-flex justify-content-end gap-2">
  <a class="btn btn-outline-secondary" href="{% url 'catalog:list' %}">Continue shopping</a>
  <a class="btn btn-primary" href="{% url 'checkout:start' %}">Checkout</a>
</div>
{% endblock %}
